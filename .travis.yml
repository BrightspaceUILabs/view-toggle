language: node_js
node_js: node
addons:
  chrome: stable
script:
- npm run lint
- |
  if [ $TRAVIS_PULL_REQUEST != false ] && [ $TRAVIS_SECURE_ENV_VARS == true ]; then
    echo "Pull request with secure environment variables, running Sauce tests...";
    npm run test:sauce || travis_terminate 1;
  else
    echo "Not a pull request and/or no secure environment variables, running headless tests...";
    npm run test:travis || travis_terminate 1;
  fi
after_success:
- frauci-update-version -d=skip && export TRAVIS_TAG=$(frauci-get-version)
env:
  global:
  - SAUCE_USERNAME: Horgan
  - REPO_NAME=view-toggle
  - OWNER_NAME=BrightspaceUILabs
  #GITHUB_RELEASE_TOKEN
  - secure: BgHS9nplSIaCGVF783+7r3Sub9NFZIt+89iCqOWeIWpN5l7LBke83PVk36N23vmNMFByIOOJa/au+rImUdkur89t6SGjzUKBnVukIQ5z8a8bW7HAAxHnA5hjmOK+oUSBe8MZ3FC2JzjT6xqsliP5sLP6dzQVX40Jhv4ALkyN/X4Qa1QSQMNj8rujUjeFHEs03TxWzoxAFAKOcWcaJFIZqxGHTPh7G6X1siBv5nJQ7qKr8OQdxsz/lciHtZdkqiEF2U0j9KgLj+3tVo8DI06ScTSI5ek/+pe4WAm7s4W6gPzkLG+KHaoDCxEU0EUZ8nOphKzFDV3zKA7xHpORe264SGRHrXEvTmNC+7NkV3gXqpbb5G65XD3LYhIzjksBEPUMhgmpHXKT64+AzSYdRXq8Ng1zjpnLbGWyjVcLO6hNKBsMT5Qq3o/oyI5IMEcTPiZsMUp+XOSSbqLyjHG/iwHwupn7Joj7OAO0VlE9Tdo1MSFO7UkDqJIWgFBjB18qk7t1yWOqskjqmGL4A499F4jq4gsaTqQhj+G4jXEWbfK/4jUKGMkCCoyqEiyHZS64/uWThD5CpG00VHI2gnUaz9i+a2Zj+p0kiNLKNJGllP6UOUcHF/g8o0fhzd7CQyhRZ1zyCQgZPnqESYjR+e1z6eKfrKPvG1eKtWcpSDbPpX3Yv2c=
  #SAUCE_ACCESS_KEY
  - secure: YsrE8kYp4VhqNP1QYKvM9gK2mVLYlMitxEYXOrTcZPVtLO1XegdswZ0cioKvM9tH1krXsdKXVelfT+yLFdQ4iOIUKr5r+Vvuer10p2SubiL4vmRI7RBvAgylOe4oPkjhPKQm37/GZPVeVkvFXjVcth4+MjZFKtR+LeJJ0N2/DbHOCeHHyRX7pKEFjLwuPd6Q8p7m2tQoVps+MnUthTs+LYLGyLYf5J7B7/xdrfEVYDC3XIuubWmR0wYj/vhROSJn67r+cegLyjxO42Sr3r96516mmrbJOoPkkTO1tX9/Dxo3L7C3xBB3byq2D3z8tItTnEExzz0wDmRsh5UKf+GuPai9PpN7vwOIjcNj612SFpUgfWzNPYRJjM1sjreb5VSrGk5MpArRdKzoi1m7GXsW85TNCKLUxhu2IchbyIPcLQ6OWjN7dbYyEdwdaXlvm3j9j3oca3lvJ4CxIqryIsZch9RtAs4DFdNQgEkKm8yGGHWHjDujjZ2mos064lxCFKR6fAUYln+DcU3OTzSKBwSrLC5JW8j0LcsD3IGoMenz5gSO7mbvsPSipWGdADPv8Si0+pJkGsmprrlwN5apZBr38C2PJr9Ef/JkAV7bpOFTQUq2NR+386v/xMtV6oW2yMxr2lJ9A4gDp27mSePDbdw4RJJSi+LDwPRMamJ5JqOzcdw=
deploy:
- provider: npm
  email: d2ltravisdeploy@d2l.com
  skip_cleanup: true
  api_key:
    #09ab......d0dd
    secure: Yh9MZeqi7oKb8hOUTMHQ4CwRM2q4esvMv6pM4PaHpfOGRRLTkK8qPY5PK+jqaWWFt2Hf6vdzhGvYpNuavQpB3MNd9BUkW0WTcAfVfJF7PYih++FoKgBk+6VPmzjikxbiTNi2Alud3f5+mrbAysVAsmmjXtdt5OjcvoCJb8c3YMW2iXiMX2frrpLYoRxevGvsEyHsNGXuznktnnnB76K+0Y5yw6/FqynZO5OXoIwWuEXb2lnIQ+Q7VMyqcxqpZLoYbF1kdJA9Hy4XZXqa2yEJrEQEA9znT8UwyVey6EIfwXqufpvltI385vAXJ8ftSrh5DjCx1LVi/UmKJIEBSLrAPPvjANEpoAbk2bPG47/yvAp7K4n0ZPmVxOYjsjwwvuEqUerCxnbuM2zq8+pEYA7yEeTGAc6WkZ1oabe+CYSg9DR2VGXJ0w7zC5hzPLdc9tdoMano90/UKFcCsfSQtXq68EFqsvhRfSs5GudYitomfVMbB28jBJkAot17C7VeXgfMl1IJKc9cJo04OYV+wT1FExUQcP+Wm1iaP9Jgxku8fLKx1+4US1loPN7wDYKietGkLZXzdbg1zRYbIVM9uNUZDGF7FsYD8TXiffIDZHS6cs+5M1pGK0+BmQMz/qlre6JX94KXzSdYZ6pcOPzWzNd6Vpluhxd5mCxes7GeFk9bEnk=
  on:
    tags: true
    repo: BrightspaceUILabs/view-toggle
